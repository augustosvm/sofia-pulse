{
  "permissions": {
    "allow": [
      "Bash(psql:*)",
      "Bash(npx tsx:*)",
      "Bash(npm install:*)",
      "Bash(timeout 60 npx tsx:*)",
      "Bash(ls:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(chmod:*)",
      "Bash(cat:*)",
      "Bash(ssh:*)",
      "Bash(ssh-add:*)",
      "Bash(ssh-keygen:*)",
      "Bash(git remote:*)",
      "Bash(pip install:*)",
      "Bash(autoflake:*)",
      "Bash(black:*)",
      "Bash(isort:*)",
      "Bash(curl:*)",
      "Bash(tee:*)",
      "Bash(then git add -A git commit -m \"style: Auto-format with black, isort, autoflake\" git push echo \"‚úÖ Mudan√ßas commitadas!\" else echo \"‚ö†Ô∏è Nenhuma mudan√ßa - c√≥digo j√° est√° formatado\" fi)",
      "Bash(git rm:*)",
      "Bash(git ls-tree:*)",
      "Bash(git pull:*)",
      "WebFetch(domain:www.catho.com.br)",
      "Bash(echo:*)",
      "Bash(grep:*)",
      "Bash(find:*)",
      "Bash(node check-jobs-count.mjs:*)",
      "Bash(python3:*)",
      "Bash(scp:*)",
      "Bash(crontab:*)",
      "Bash(bash:*)",
      "Bash(comm -23:*)",
      "Bash(PROJECT_DIR=\"/mnt/c/Users/augusto.moreira/Documents/sofia-pulse\":*)",
      "Bash(CATHO_LINE=\"0 10 * * * npx tsx scripts/collect.ts catho >> /mnt/c/Users/augusto.moreira/Documents/sofia-pulse/logs/catho-collector.log 2>&1\")",
      "Bash(git reset:*)",
      "Bash(for f in ai-huggingface-models basedosdados-brazil currency-rates epo-patents gitguardian-incidents hkex-ipos ibge-api ilostat-labor reddit-tech sec-edgar-funding wipo-china-patents)",
      "Bash(do)",
      "Bash(if [ -f \"scripts/collect-$f.ts\" ])",
      "Bash([ -f \"scripts/collect-$f.py\" ])",
      "Bash(then)",
      "Bash(else)",
      "Bash(fi)",
      "Bash(done)",
      "Bash(timeout 10 npx tsx:*)",
      "Bash(for f in ai-huggingface-models basedosdados-brazil currency-rates epo-patents gitguardian-incidents hkex-ipos ilostat-labor wipo-china-patents)",
      "Bash(do if [ -f \"scripts/collect-$f.ts\" ])",
      "Bash(then echo \"‚úÖ $f.ts exists\" elif [ -f \"scripts/collect-$f.py\" ])",
      "Bash(then echo \"üêç $f.py exists\" else echo \"‚ùå $f NOT FOUND\" fi)",
      "Bash(then echo \"‚úÖ $f\")",
      "Bash(else echo \"‚ùå $f NOT FOUND\")",
      "Bash(then echo \"üìò $f ‚Üí TypeScript\")",
      "Bash(elif [ -f \"scripts/collect-$f.py\" ])",
      "Bash(then echo \"üêç $f ‚Üí Python\")",
      "Bash(timeout 30 npx tsx:*)",
      "Bash(timeout 15 npx tsx:*)",
      "Bash(dos2unix:*)",
      "Bash(timeout 30 python3:*)",
      "Bash(timeout 90 npx tsx:*)",
      "Bash(timeout 120 npx tsx:*)",
      "Bash(timeout 60 python3:*)",
      "Bash(timeout 300 bash:*)",
      "Bash(‚úÖ)",
      "Bash(Complete)",
      "Bash(COMPLETE\" | tail -3\n    echo \"\"\ndone\nEOFSH\nbash run-remaining-collectors.sh\")",
      "Bash(ClinicalTrials.gov Collector)",
      "Bash(Coleta dados de ensaios cl√≠nicos de tecnologias m√©dicas e tratamentos)",
      "Bash(API: https://clinicaltrials.gov/api/v2/)",
      "Bash(\"\"\"\n\nimport os\nimport sys\nfrom datetime import datetime, timedelta\nimport psycopg2\nimport requests\nfrom dotenv import load_dotenv\n\n# Load environment variables\nload_dotenv\\(\\)\n\n# Database connection\nDB_CONFIG = {\n    ''host'': os.getenv\\(''POSTGRES_HOST'', ''localhost''\\),\n    ''port'': int\\(os.getenv\\(''POSTGRES_PORT'', ''5432''\\)\\),\n    ''user'': os.getenv\\(''POSTGRES_USER'', ''sofia''\\),\n    ''password'': os.getenv\\(''POSTGRES_PASSWORD'', ''''\\),\n    ''database'': os.getenv\\(''POSTGRES_DB'', ''sofia_db''\\),\n}\n\ndef create_table\\(conn\\):\n    \"\"\"\"\"\"Create clinical_trials table if not exists\"\"\"\"\"\"\n    cur = conn.cursor\\(\\)\n    cur.execute\\(''''''\n        CREATE TABLE IF NOT EXISTS sofia.clinical_trials \\(\n            nct_id VARCHAR\\(20\\) PRIMARY KEY,\n            title TEXT NOT NULL,\n            brief_summary TEXT,\n            condition TEXT,\n            intervention_name TEXT,\n            phase VARCHAR\\(20\\),\n            status VARCHAR\\(50\\),\n            enrollment_count INTEGER,\n            start_date DATE,\n            completion_date DATE,\n            sponsor TEXT,\n            study_type VARCHAR\\(50\\),\n            keywords TEXT[],\n            collected_at TIMESTAMP DEFAULT NOW\\(\\)\n        \\)\n    ''''''\\)\n    conn.commit\\(\\)\n    cur.close\\(\\)\n\ndef collect_trials\\(\\):\n    \"\"\"\"\"\"Collect clinical trials from ClinicalTrials.gov API\"\"\"\"\"\"\n    \n    print\\(''='' * 80\\)\n    print\\(''CLINICALTRIALS.GOV COLLECTOR''\\)\n    print\\(''='' * 80\\)\n    print\\(\\)\n    \n    # Connect to database\n    try:\n        conn = psycopg2.connect\\(**DB_CONFIG\\)\n        print\\(''‚úÖ Database connected''\\)\n        create_table\\(conn\\)\n    except Exception as e:\n        print\\(f''‚ùå Database connection failed: {e}''\\)\n        return\n    \n    # Technology/medical device related conditions\n    conditions = [\n        ''artificial intelligence'',\n        ''machine learning'',\n        ''digital health'',\n        ''telemedicine'',\n        ''medical device'',\n        ''robotic surgery'',\n        ''gene therapy'',\n        ''immunotherapy''\n    ]\n    \n    total_trials = 0\n    \n    for condition in conditions:\n        print\\(f''üîç Searching: {condition}''\\)\n        \n        try:\n            # ClinicalTrials.gov API v2\n            url = ''https://clinicaltrials.gov/api/v2/studies''\n            params = {\n                ''query.cond'': condition,\n                ''filter.overallStatus'': ''RECRUITING,ACTIVE_NOT_RECRUITING,COMPLETED'',\n                ''pageSize'': 50,\n                ''format'': ''json''\n            }\n            \n            response = requests.get\\(url, params=params, timeout=30\\)\n            response.raise_for_status\\(\\)\n            data = response.json\\(\\)\n            \n            studies = data.get\\(''studies'', []\\)\n            print\\(f''   ‚úÖ Found {len\\(studies\\)} trials''\\)\n            \n            cur = conn.cursor\\(\\)\n            \n            for study in studies:\n                protocol = study.get\\(''protocolSection'', {}\\)\n                id_module = protocol.get\\(''identificationModule'', {}\\)\n                status_module = protocol.get\\(''statusModule'', {}\\)\n                description_module = protocol.get\\(''descriptionModule'', {}\\)\n                conditions_module = protocol.get\\(''conditionsModule'', {}\\)\n                design_module = protocol.get\\(''designModule'', {}\\)\n                arms_module = protocol.get\\(''armsInterventionsModule'', {}\\)\n                sponsor_module = protocol.get\\(''sponsorCollaboratorsModule'', {}\\)\n                \n                nct_id = id_module.get\\(''nctId'', ''''\\)\n                if not nct_id:\n                    continue\n                \n                # Insert or update\n                cur.execute\\(''''''\n                    INSERT INTO sofia.clinical_trials \\(\n                        nct_id, title, brief_summary, condition, intervention_name,\n                        phase, status, enrollment_count, start_date, completion_date,\n                        sponsor, study_type, keywords\n                    \\) VALUES \\(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s\\)\n                    ON CONFLICT \\(nct_id\\) DO UPDATE SET\n                        title = EXCLUDED.title,\n                        brief_summary = EXCLUDED.brief_summary,\n                        status = EXCLUDED.status,\n                        collected_at = NOW\\(\\)\n                '''''', \\(\n                    nct_id,\n                    id_module.get\\(''briefTitle'', ''''\\)[:500],\n                    description_module.get\\(''briefSummary'', ''''\\)[:1000],\n                    '', ''.join\\(conditions_module.get\\(''conditions'', []\\)\\)[:500],\n                    '', ''.join\\([i.get\\(''name'', ''''\\) for i in arms_module.get\\(''interventions'', []\\)]\\)[:500],\n                    design_module.get\\(''phases'', [''N/A'']\\)[0] if design_module.get\\(''phases''\\) else ''N/A'',\n                    status_module.get\\(''overallStatus'', ''Unknown''\\),\n                    design_module.get\\(''enrollmentInfo'', {}\\).get\\(''count''\\),\n                    status_module.get\\(''startDateStruct'', {}\\).get\\(''date''\\),\n                    status_module.get\\(''completionDateStruct'', {}\\).get\\(''date''\\),\n                    sponsor_module.get\\(''leadSponsor'', {}\\).get\\(''name'', ''''\\)[:500],\n                    design_module.get\\(''studyType'', ''N/A''\\),\n                    conditions_module.get\\(''keywords'', []\\)[:20]\n                \\)\\)\n                \n                total_trials += 1\n            \n            conn.commit\\(\\)\n            cur.close\\(\\)\n            \n        except Exception as e:\n            print\\(f''   ‚ùå Error: {e}''\\)\n            continue\n    \n    conn.close\\(\\)\n    \n    print\\(\\)\n    print\\(''='' * 80\\)\n    print\\(''‚úÖ CLINICAL TRIALS COLLECTION COMPLETE''\\)\n    print\\(''='' * 80\\)\n    print\\(f''üíæ Total trials: {total_trials}''\\)\n    print\\(\\)\n\nif __name__ == ''__main__'':\n    collect_trials\\(\\)\nEOF\nchmod +x collect-clinical-trials.py && echo ''‚úÖ Clinical trials collector created''\")",
      "Bash(sudo apt-get update:*)",
      "Bash(sudo apt-get install:*)",
      "Bash(python:*)",
      "Bash(PYTHONIOENCODING=utf-8 python:*)",
      "Bash(set:*)",
      "Bash(chcp:*)",
      "Bash(SELECT table_name)",
      "Bash(FROM information_schema.tables)",
      "Bash(WHERE table_schema = 'sofia')",
      "Bash(ORDER BY table_name)",
      "Bash(\"\"\"\\)\n    \n    tables = [row[''table_name''] for row in cursor.fetchall\\(\\)]\n    print\\(''=== TABLES IN SOFIA SCHEMA ===''\\)\n    for table in tables:\n        print\\(f''  - {table}''\\)\n    \n    conn.close\\(\\)\nexcept Exception as e:\n    print\\(f''Error: {e}''\\)\nEOF\n\")",
      "Bash(git checkout:*)"
    ]
  }
}
